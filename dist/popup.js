import{j as e,f as h,u as m,g as v,a as f,i as j,b as k,c as u,r as i,C as g,d as N,R as w}from"./js/clsx.js";const C=()=>{const t=new Date;return e.jsx("header",{className:"bg-primary-light dark:bg-primary-dark text-white p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Calendar TODO"}),e.jsx("p",{className:"text-sm opacity-90",children:h(t,"yyyy年M月d日 (E)")})]}),e.jsx("button",{onClick:()=>chrome.runtime.openOptionsPage(),className:"p-2 hover:bg-white/10 rounded",title:"設定",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})})]})})},D=()=>{const{selectedDate:t,setSelectedDate:d,tasks:o}=m(),l=v(t),s=a=>o.filter(r=>h(r.dueDate,"yyyy-MM-dd")===h(a,"yyyy-MM-dd")&&!r.completed).length;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm",children:[e.jsx("div",{className:"text-center mb-2 font-semibold text-sm",children:f(t)}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["日","月","火","水","木","金","土"].map(a=>e.jsx("div",{className:"text-center text-xs font-medium text-gray-500 dark:text-gray-400",children:a},a)),l.map(a=>{const r=s(a),c=j(a),x=k(a,t);return e.jsxs("button",{onClick:()=>d(a),className:u("relative aspect-square flex flex-col items-center justify-center text-xs rounded hover:bg-gray-100 dark:hover:bg-gray-700",c&&"bg-blue-100 dark:bg-blue-900 font-bold",!x&&"opacity-40"),children:[e.jsx("span",{children:a.getDate()}),r>0&&e.jsx("div",{className:"absolute bottom-0 w-1 h-1 bg-red-500 rounded-full"})]},a.toISOString())})]})]})},b=({task:t})=>{const{toggleTaskComplete:d,deleteTask:o,categories:l}=m(),s=l.find(r=>r.id===t.category),a=r=>{switch(r){case"high":return"border-red-500";case"medium":return"border-yellow-500";case"low":return"border-green-500";default:return"border-gray-300"}};return e.jsxs("div",{className:u("flex items-start gap-2 p-2 bg-gray-50 dark:bg-gray-700 rounded border-l-2",a(t.priority),t.completed&&"opacity-60"),children:[e.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>d(t.id),className:"mt-0.5 cursor-pointer"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:u("text-sm font-medium",t.completed&&"line-through"),children:t.title}),t.description&&e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{backgroundColor:s.color+"20",color:s.color},children:s.name}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:h(t.dueDate,"HH:mm")})]})]}),e.jsx("button",{onClick:()=>o(t.id),className:"text-red-500 hover:text-red-700 text-xs",title:"削除",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})},T=({tasks:t})=>{const d=t.filter(s=>j(s.dueDate)),o=d.filter(s=>!s.completed),l=d.filter(s=>s.completed);return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm",children:[e.jsxs("h2",{className:"text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300",children:["今日のタスク (",o.length,")"]}),d.length===0?e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center py-4",children:"今日のタスクはありません"}):e.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[o.map(s=>e.jsx(b,{task:s},s.id)),l.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["完了済み (",l.length,")"]}),l.map(s=>e.jsx(b,{task:s},s.id))]})]})]})},S=({onAddTask:t,categories:d})=>{var y;const[o,l]=i.useState(""),[s,a]=i.useState(((y=d[0])==null?void 0:y.id)||""),[r,c]=i.useState("medium"),x=n=>{if(n.preventDefault(),!o.trim())return;const p=new Date;p.setHours(23,59,59,999),t({title:o.trim(),dueDate:p,priority:r,category:s,completed:!1}),l("")};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm",children:[e.jsx("h2",{className:"text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300",children:"クイック追加"}),e.jsxs("form",{onSubmit:x,className:"space-y-2",children:[e.jsx("input",{type:"text",value:o,onChange:n=>l(n.target.value),placeholder:"タスクを入力...",className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:s,onChange:n=>a(n.target.value),className:"flex-1 px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:d.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))}),e.jsxs("select",{value:r,onChange:n=>c(n.target.value),className:"px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"high",children:"高"}),e.jsx("option",{value:"medium",children:"中"}),e.jsx("option",{value:"low",children:"低"})]}),e.jsx("button",{type:"submit",className:"px-4 py-1 text-xs bg-primary-light dark:bg-primary-dark text-white rounded hover:opacity-90",children:"追加"})]})]})]})},M=()=>{const{tasks:t,categories:d,settings:o,addTask:l}=m();i.useEffect(()=>{(async()=>{try{const[r,c,x]=await Promise.all([g.getTasks(),g.getCategories(),g.getSettings()]);r.length>0&&m.setState({tasks:r}),c.length>0&&m.setState({categories:c}),x&&m.setState({settings:x})}catch(r){console.error("Failed to load data from Chrome storage:",r)}})()},[]),i.useEffect(()=>{g.saveTasks(t)},[t]),i.useEffect(()=>{g.saveCategories(d)},[d]),i.useEffect(()=>{g.saveSettings(o)},[o]);const s=()=>{chrome.tabs.create({url:chrome.runtime.getURL("options.html")})};return e.jsxs("div",{className:"popup-container bg-background-light dark:bg-background-dark",children:[e.jsx(C,{}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx(D,{})}),e.jsx("div",{className:"mb-4",children:e.jsx(S,{onAddTask:l,categories:d})}),e.jsx("div",{className:"mb-4",children:e.jsx(T,{tasks:t})}),e.jsx("button",{onClick:s,className:"w-full btn-primary",children:"フルビューで開く"})]})]})};N.createRoot(document.getElementById("root")).render(e.jsx(w.StrictMode,{children:e.jsx(M,{})}));
